<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ YZ Destekli TÃ¼rkiye Deprem Ä°zleme Sistemi</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŒ</text></svg>">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŒ YZ Destekli TÃ¼rkiye Deprem Ä°zleme</h1>
            <p class="subtitle">GerÃ§ek zamanlÄ± deprem analizi ve erken uyarÄ± sistemi</p>
        </div>

        <!-- Modern Asymmetric Grid Layout -->
        <div class="cards-grid">
            <!-- BÃ¼yÃ¼k Kart - Haritalar (2 kolon) -->
            <div class="card card-large card-featured">
                <div class="card-badge">â­ Ã–NE Ã‡IKAN</div>
                <h2>ğŸ—ºï¸ CanlÄ± Deprem HaritalarÄ±</h2>
                <div class="maps-container">
                    <div class="map-wrapper">
                        <h3>ğŸ¤– YZ Risk Analizi</h3>
                        <div id="mapid"></div>
                    </div>
                    <div class="map-wrapper">
                        <h3>ğŸ“ Son 1 GÃ¼n Depremler & Aktif Fay HatlarÄ±</h3>
                        <div id="mapid2"></div>
                    </div>
                </div>
                <button id="refreshButton" class="btn-modern btn-large">ğŸ”„ HaritalarÄ± Yenile</button>
                <div id="earthquake-list" style="margin-top: 20px;">
                    <p>YZ Risk analizi verileri yÃ¼kleniyor...</p>
                </div>
            </div>

            <!-- Orta Kart - Ä°stanbul (1 kolon, yÃ¼ksek) -->
            <div class="card card-medium card-istanbul">
                <div class="card-icon">ğŸ›ï¸</div>
                <h2>Ä°stanbul Erken UyarÄ±</h2>
                <p style="margin-bottom: 20px; color: rgba(255, 255, 255, 0.9) !important; font-size: 0.95em;">
                    Ä°stanbul iÃ§in Ã¶zel geliÅŸtirilmiÅŸ yapay zeka destekli erken uyarÄ± sistemi. Deprem Ã¶ncesi sinyalleri tespit ederek Ã¶nceden uyarÄ± verir.
                </p>
                <button id="checkIstanbulWarningButton" class="btn-modern btn-primary">ğŸ” Durum Kontrol Et</button>
                
                <div class="divider"></div>
                
                <h3 style="margin: 25px 0 15px 0; color: #ffffff !important; font-size: 1.1em;">ğŸ“± WhatsApp Bildirimleri</h3>
                <p style="margin-bottom: 15px; color: rgba(255, 255, 255, 0.8) !important; font-size: 0.9em;">
                    UyarÄ± seviyeleri: KRÄ°TÄ°K (0-24 saat), YÃœKSEK (24-72 saat), ORTA (1 hafta).
                </p>
                <div class="warning-box">
                    <p style="margin: 0; font-size: 0.85em; color: #ffffff !important;">
                        âš ï¸ <strong>Ã–nemli:</strong> Bildirim alabilmek iÃ§in numaranÄ±zÄ± Twilio WhatsApp Sandbox'a eklemeniz gerekiyor (Ã¼cretsiz).
                    </p>
                </div>
                <input type="tel" id="istanbulNumberInput" placeholder="+905xxxxxxxxx" class="input-modern">
                <button id="saveIstanbulAlertButton" class="btn-modern btn-success">ğŸ”” Bildirimleri AktifleÅŸtir</button>
                <div id="istanbulAlertResult" style="margin-top: 15px; display: none;"></div>
            </div>

            <!-- KÃ¼Ã§Ã¼k Kartlar - Grid -->
            <div class="card card-small">
                <div class="card-icon">ğŸ™ï¸</div>
                <h2>Ä°l BazÄ±nda Risk</h2>
                <p style="margin-bottom: 15px; color: rgba(255, 255, 255, 0.9) !important; font-size: 0.9em;">
                    TÃ¼m illerin risk analizi. Bina risk analizi dahil!
                </p>
                <button id="analyzeCityDamageButton" class="btn-modern btn-secondary">ğŸ” Analiz Yap</button>
            </div>

            <div class="card card-small">
                <div class="card-icon">ğŸ‡¹ğŸ‡·</div>
                <h2>TÃ¼rkiye UyarÄ±</h2>
                <p style="margin-bottom: 15px; color: rgba(255, 255, 255, 0.9) !important; font-size: 0.9em;">
                    M â‰¥ 5.0 deprem riski iÃ§in erken uyarÄ± sistemi.
                </p>
                <button id="checkTurkeyWarningButton" class="btn-modern btn-warning">ğŸ” Kontrol Et</button>
            </div>

            <div class="card card-small">
                <div class="card-icon">ğŸ”®</div>
                <h2>AI Risk Tahmini</h2>
                <p style="margin-bottom: 15px; color: rgba(255, 255, 255, 0.9) !important; font-size: 0.9em;">
                    Konumunuz iÃ§in geliÅŸmiÅŸ yapay zeka destekli risk tahmini.
                </p>
                <button id="predictRiskButton" class="btn-modern btn-info">ğŸ“ Risk Tahmini</button>
            </div>

            <!-- GeniÅŸ Kart - WhatsApp AyarlarÄ± (2 kolon) -->
            <div class="card card-wide">
                <div class="card-header-flex">
                    <div>
                        <div class="card-icon">ğŸš¨</div>
                        <h2>Acil Durum Bildirimleri</h2>
                    </div>
                </div>
                <div class="settings-grid">
                    <div class="setting-section">
                        <h3 style="margin-bottom: 15px; color: #ffffff !important; font-size: 1.1em;">ğŸ“ 1. Konumunuzu Belirleyin</h3>
                        <button id="getLocationButton" class="btn-modern btn-outline">ğŸ“ Konumumu Belirle</button>
                        <p id="locationStatus" style="margin-top: 15px; font-weight: 500; min-height: 20px;"></p>
                    </div>
                    <div class="setting-section">
                        <h3 style="margin-bottom: 15px; color: #ffffff !important; font-size: 1.1em;">ğŸ“± 2. WhatsApp NumarasÄ±</h3>
                        <input type="tel" id="numberInput" placeholder="+905xxxxxxxxx" class="input-modern">
                        <button id="saveSettingsButton" class="btn-modern btn-success" style="width: 100%; margin-top: 15px;">ğŸ’¾ Kaydet ve AktifleÅŸtir</button>
                        <p style="margin-top: 15px; font-style: italic; color: rgba(255, 255, 255, 0.7) !important; font-size: 0.85em;">
                            * M â‰¥ 5.0 depremlerde 150 km iÃ§indeyse bildirim alÄ±rsÄ±nÄ±z.
                        </p>
                    </div>
                </div>
                <div class="info-box" style="margin-top: 20px;">
                    <h4 style="margin: 0 0 10px 0; color: #ffffff;">ğŸ“± WhatsApp Bildirimleri (Meta WhatsApp Business API)</h4>
                    <p style="margin: 5px 0 15px 0; font-size: 0.9em; color: rgba(255, 255, 255, 0.9) !important;">
                        <strong>YENÄ°:</strong> Meta WhatsApp Business API kullanÄ±yoruz! Serbest metin bildirimleri iÃ§in Ã¶nce session aÃ§manÄ±z gerekiyor.
                    </p>
                    <div id="optInSection" style="background: rgba(46, 204, 113, 0.1); border: 1px solid rgba(46, 204, 113, 0.3); border-radius: 10px; padding: 15px; margin: 15px 0;">
                        <h5 style="margin: 0 0 10px 0; color: #2ecc71; font-size: 1em;">âœ… AdÄ±m 1: Session AÃ§Ä±n (Opt-In)</h5>
                        <p style="margin: 5px 0 10px 0; font-size: 0.85em; color: rgba(255, 255, 255, 0.8);">
                            AÅŸaÄŸÄ±daki linke tÄ±klayÄ±p WhatsApp'ta <strong>"basla"</strong> yazÄ±n. Sonra 24 saat boyunca serbest metin bildirimleri alabilirsiniz.
                        </p>
                        <button id="getOptInLinkButton" class="btn-modern btn-primary" style="width: 100%; margin-bottom: 10px;">
                            ğŸ”— Session AÃ§ma Linkini Al
                        </button>
                        <div id="optInLinkDisplay" style="display: none; margin-top: 10px;">
                            <a id="optInLink" href="#" target="_blank" style="color: #2ecc71; text-decoration: underline; word-break: break-all; display: block; margin: 5px 0;">
                                Link yÃ¼kleniyor...
                            </a>
                            <p style="margin: 5px 0 0 0; font-size: 0.8em; color: rgba(255, 255, 255, 0.7);">
                                ğŸ’¡ Bu linke tÄ±klayÄ±p WhatsApp'ta "basla" yazÄ±n. Sonra bildirimler otomatik gelecek!
                            </p>
                        </div>
                    </div>
                    <div style="background: rgba(243, 156, 18, 0.1); border: 1px solid rgba(243, 156, 18, 0.3); border-radius: 10px; padding: 15px; margin: 15px 0;">
                        <h5 style="margin: 0 0 10px 0; color: #f39c12; font-size: 1em;">ğŸ“± Alternatif: Twilio Sandbox</h5>
                        <p style="margin: 5px 0; font-size: 0.85em; color: rgba(255, 255, 255, 0.7);">
                            Ä°sterseniz Twilio WhatsApp Sandbox'Ä± da kullanabilirsiniz (eski yÃ¶ntem).
                        </p>
                        <ol style="margin: 10px 0; padding-left: 20px; font-size: 0.85em; color: rgba(255, 255, 255, 0.7);">
                            <li>Twilio Console: <a href="https://console.twilio.com" target="_blank" style="color: #FFC107;">console.twilio.com</a></li>
                            <li><strong>Messaging</strong> > <strong>Try it out</strong> > <strong>Send a WhatsApp message</strong></li>
                            <li><strong>"Join code"</strong> kÄ±smÄ±ndaki kodu kopyalayÄ±n</li>
                            <li>WhatsApp'tan <strong>+1 415 523 8886</strong> numarasÄ±na bu kodu gÃ¶nderin</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modern Modal System -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-container">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">BaÅŸlÄ±k</h2>
                <button class="modal-close" id="modalClose">âœ•</button>
            </div>
            <div class="modal-content" id="modalContent">
                <!-- Ä°Ã§erik buraya gelecek -->
            </div>
        </div>
    </div>

    <!-- Chatbot -->
    <div class="chatbot-container">
        <div class="chatbot-window" id="chatbotWindow">
            <div class="chatbot-header">
                <div>
                    <strong>ğŸ¤– Deprem AsistanÄ±</strong>
                    <div style="font-size: 0.8em; opacity: 0.9;">Size nasÄ±l yardÄ±mcÄ± olabilirim?</div>
                </div>
                <button id="closeChatbot" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">âœ•</button>
            </div>
            <div class="chatbot-messages" id="chatbotMessages">
                <div class="message bot">
                    <div class="message-bubble">
                        Merhaba! Ben deprem asistanÄ±nÄ±z. Depremler, gÃ¼venlik Ã¶nlemleri ve risk analizi hakkÄ±nda sorularÄ±nÄ±zÄ± yanÄ±tlayabilirim. NasÄ±l yardÄ±mcÄ± olabilirim?
                    </div>
                </div>
            </div>
            <div class="chatbot-input-container">
                <input type="text" class="chatbot-input" id="chatbotInput" placeholder="MesajÄ±nÄ±zÄ± yazÄ±n...">
                <button class="chatbot-send" id="chatbotSend">â¤</button>
            </div>
        </div>
        <button class="chatbot-toggle" id="chatbotToggle">ğŸ’¬</button>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
</body>
</html>
